NAME

MooseX::Role::UserDaemon

VERSION

Version 0.05

SYNOPSIS

In your module:

    package YourApp;
    use Moose;
    with qw(MooseX::Role::UserDaemon);

    # MooseX::UserDaemon requires the consuming class to implement main()
    sub main {
      my ($self) = @_;

      # the user have to implement capturing signals and exiting.
      my $run = 1;
      local $SIG{'INT'} = sub { $run = 0; };

      FOREVER_LOOP:
      while ($run) {
        ...
      }
      
      # It is recomended that main() return '0 but true' on success.
      # the return value of main is feed directly to exit()
      return '0 but true';
    }

In your script:

    use YourApp;
    my $app = YourApp->new;

    exit $app->run unless caller 0;

On the commanline:

	Start your app
	$ myapp.pl start
		Starting...

	Check your status
	$ myapp.pl status
		Running with PID: ...

	Stop your app
	$ myapp.pl stop
		Stopping PID: ...

Or preferably in combination with MooseX::SimpleConfig and/or MooseX::Getopt

In your module:
    package YourApp;
    use Moose;

    # Enable use of configfile and commandline parameters as well
    with qw(MooseX::SimpleConfig MooseX::Getopt MooseX::Role::UserDaemon);

    # '+configfile' Only required when using MooseX::SimpleConfig
    has '+configfile' => (
      is            => 'ro',
      isa           => 'Str',
      default       =>
        sub { join q{/}, $ENV{'HOME'}, '.yourapp/yourapp.conf' },
      documentation => 'Use custom configfile.',
    );

    # MooseX::UserDaemon requires the consuming class to implement main()
    sub main {
      my ($self) = @_;

      # the user have to implement capturing signals and exiting.
      my $run = 1;
      local $SIG{'INT'} = sub { $run = 0; };

      FOREVER_LOOP:
      while ($run) {
        sleep 1; # This is where you place your code
      }
      
      # It is recomended that main() return '0 but true' on success.
      # the return value of main is feed directly to exit()
      return '0 but true';
    }

In your script:

    use YourApp;
    my $app = YourApp->new_with_options;

    exit $app->run unless caller 0;

On the commanline:

	Start your app
	$ myapp.pl start
		Starting...

	Check your status
	$ myapp.pl status
		Running with PID: ...

	Stop your app
	$ myapp.pl stop
		Stopping PID: ...

INSTALLATION

To install this module, run the following commands:

	perl Makefile.PL
	make
	make test
	make install

SUPPORT AND DOCUMENTATION

After installing, you can find documentation for this module with the
perldoc command.

    perldoc MooseX::Role::UserDaemon

LICENSE AND COPYRIGHT

Copyright (C) 2013 Tore Andersson

This program is free software; you can redistribute it and/or modify it
under the terms of either: the GNU General Public License as published
by the Free Software Foundation; or the Artistic License.

See http://dev.perl.org/licenses/ for more information.

